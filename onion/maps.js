
var exceptSurfaces = ["/", undefined, "Q", "R", "Z"];
var constrainSurfaces = ["/", undefined];

var squareSize = 40;
/*Maps are stored as objects. First all the attributes about the map are stored in these variables, then the actual map is defined.
LoadingMap is a reference to the actual map. 

Exits are also objects  */

class Map {
    constructor(data, pallete, name, exits, enemies, statics) {
        this.data = data;
        this.pallete = pallete;
        this.name = name;
        this.exits = exits;
        this.enemies = enemies;
        this.statics = statics;
    }
}

class Exit {
    constructor(mapToSwitchTo, xChange, yChange) {
        this.mapSwitch = mapToSwitchTo;
        this.x = xChange;
        this.y = yChange;
    }

    run() {
        //updating player position and map
        character.x += this.x;
        character.y += this.y;
        loadingMap = eval(this.mapSwitch);

        //determining whether the map should constrain the camera. Boolean equations took me a while to get used to, but they just sort of exist.
        constrainC = [false, false];
        constrainC[0] = loadingMap.data[0].length * squareSize > canvas.width;
        constrainC[1] = loadingMap.data.length * squareSize > canvas.height * menuPos;
    }
}
var tutorial1Data = [["A", "A", "A", "A", "A", "A", "A", "A", "A", "A", "A", "A", "A", "A", "A", "A", "A"],
                    ["A", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "A"],
                    ["A", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "A"],
                    ["A", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "A"],
                    ["1", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "2"],
                    ["1", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "2"],
                    ["A", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "A"],
                    ["A", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "A"],
                    ["A", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "A"],
                    ["A", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "A"],
                    ["A", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "A"],
                    ["A", "A", "A", "A", "A", "A", "A", "A", "A", "A", "A", "A", "A", "A", "A", "A", "A"]];

var tutorial1Exits = [];
let tutorial1 = new Map(tutorial1Data, 20, "tutorial1", tutorial1Exits, [], []);

var homeData = [["A", "A", "A", "A", "A", "A", "A", "A", "A", "A"],
                ["A", "0", "0", "0", "0", "0", "0", "0", "0", "A"],
                ["A", "0", "0", "0", "0", "0", "0", "0", "0", "A"],
                ["A", "0", "0", "0", "0", "0", "0", "0", "0", "A"],
                ["A", "0", "0", "0", "0", "0", "0", "0", "0", "A"],
                ["A", "0", "0", "0", "0", "0", "0", "0", "0", "A"],
                ["A", "0", "0", "0", "0", "0", "0", "0", "0", "A"],
                ["A", "0", "0", "0", "0", "0", "0", "A", "A", "A"],
                ["A", "0", "0", "0", "0", "0", "0", "A"],
                ["A", "0", "0", "0", "0", "0", "0", "A"],
                ["A", "0", "0", "0", "0", "0", "0", "A"],
                ["A", "A", "A", "1", "A", "A", "A", "A"]];

var homeExits = [new Exit("selya", 3 * squareSize, -8 * squareSize)];

let home = new Map(homeData, 2, "home", homeExits, [], []);

var selyaData = [  ["A", "A", "A", "A", "A", "A", "A", "A", "A", "A", "A", "A", "A", "A", "A", "A", "A", "A", "A", "A", "A", "A", "A", "A", "A", "A"],
                   ["A", "i", "B", "0", "0", "0", "0", "0", "0", "D", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "A"],
                   ["A", "0", "B", "0", "0", "i", "i", "i", "0", "D", "0", "0", "0", "0", "0", "0", "S", "0", "0", "0", "0", "0", "0", "0", "0", "1"],
                   ["A", "0", "B", "0", "0", "i", "/", "i", "0", "D", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "1"],
                   ["A", "0", "B", "0", "0", "i", "4", "i", "0", "D", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "A"],
                   ["A", "0", "B", "0", "0", "0", "0", "0", "0", "D", "0", "0", "0", "0", "S", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "A"],
                   ["A", "0", "B", "0", "0", "0", "0", "0", "0", "D", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "A"],
                   ["A", "0", "F", "E", "E", "E", "E", "E", "R", "I", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "A"],
                   ["A", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "A"],
                   ["A", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "A"],
                   ["A", "0", "0", "0", "A", "A", "A", "A", "A", "0", "0", "A", "D", "0", "0", "G", "C", "C", "C", "H", "0", "0", "0", "0", "0", "A"],
                   ["A", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "D", "0", "0", "B", "0", "0", "0", "D", "0", "0", "0", "0", "0", "A"],
                   ["A", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "D", "0", "0", "B", "0", "0", "0", "D", "0", "0", "0", "0", "0", "A"],
                   ["A", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "D", "0", "0", "B", "0", "0", "0", "D", "0", "0", "0", "0", "0", "A"],
                   ["A", "0", "0", "0", "0", "i", "i", "i", "0", "0", "0", "0", "D", "0", "0", "F", "E", "R", "E", "I", "0", "0", "0", "0", "0", "A"],
                   ["A", "0", "0", "0", "0", "i", "/", "i", "0", "0", "0", "0", "D", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "A"],
                   ["A", "0", "0", "0", "0", "i", "3", "i", "0", "0", "0", "0", "D", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "A"],
                   ["A", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "D", "0", "0", "S", "0", "0", "0", "0", "0", "0", "0", "0", "0", "A"],
                   ["A", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "D", "D", "D", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "A"],
                   ["A", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "D", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "A"],
                   ["A", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "D", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "A"],
                   ["A", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "D", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "A"],
                   ["A", "E", "E", "E", "E", "E", "E", "E", "E", "E", "E", "E", "I", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "A"],
                   ["A", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "A"],
                   ["A", "A", "A", "A", "A", "A", "A", "A", "A", "A", "A", "A", "A", "A", "A", "A", "A", "2", "2", "A", "A", "A", "A", "A", "A", "A"]];


var selyaExits = [  new Exit("rightMap", -1 * (selyaData[0].length * squareSize), 0),
                    new Exit("downMap", -1 * squareSize, -1 * selyaData.length * squareSize),
                    new Exit("potionShop", -3 * squareSize, -14 * squareSize),
                    new Exit("home", -3 * squareSize, 8 * squareSize)];

var selyaEnemies = [new Chatter(squareSize, squareSize*13),
                    new ConvoStarter(squareSize*8.2, squareSize*8, squareSize, 2),
                    new NPC(squareSize*8.2, squareSize*8, 0, "#333333", joinText, "joinText"),
                    new Box(squareSize*1, squareSize*1, "new Item(1, 1, 1, false)")];
                      
var selyaStatics = [new House(squareSize*6, squareSize*3),
                    new House(squareSize*6, squareSize*15)];

let selya = new Map(selyaData, 1, "selya", selyaExits, selyaEnemies, selyaStatics);
                      

var rightMapData = [["A", "A", "A", "A", "A", "A", "A", "A", "A", "A", "A", "A", "A", "A", "A", "A", "A", "A", "A", "A", "A"],
                   ["A", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "A"],
                   ["1", "0", "0", "S", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "S", "0", "Z", "0", "S", "Z", "A"],
                   ["1", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "S", "0", "Z", "A"],
                   ["A", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "Z", "0", "2"],
                   ["A", "0", "0", "0", "0", "0", "0", "0", "0", "S", "0", "0", "0", "0", "0", "Z", "0", "0", "Z", "0", "2"],
                   ["A", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "Z", "Z", "S", "Z", "2"],
                   ["A", "0", "0", "0", "0", "0", "0", "S", "0", "0", "0", "0", "0", "0", "0", "0", "S", "Z", "0", "Z", "A"],
                   ["A", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "S", "0", "0", "0", "0", "S", "A"],
                   ["A", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "S", "Z", "A"],
                   ["A", "A", "A", "A", "A", "A", "A", "A", "A", "A", "A", "A", "A", "A", "A", "A", "A", "A", "A", "A", "A"]];

var rightMapExits = [new Exit("selya", selyaData[0].length * squareSize, 0),
                    new Exit("stoneEntrance", -1 * (rightMapData[0].length * squareSize), -2 * squareSize)];

var rightMapEnemies = [new Slime(160, 60),
                       new Ground(160, 120, 20, 50, 1),
                       new Slime(160, 60),
                       new Slime(160, 60)];

var rightMapStatics = [];

let rightMap = new Map(rightMapData, 1, "rightMap", rightMapExits, rightMapEnemies, rightMapStatics);


var shopData = [["A", "A", "A", "1", "A", "A", "A", "A"],
                ["A", "0", "0", "0", "0", "0", "0", "A"],
                ["A", "0", "0", "0", "0", "0", "0", "A"],
                ["A", "0", "0", "0", "0", "0", "0", "A"],
                ["A", "0", "0", "0", "0", "0", "0", "A"],
                ["A", "0", "0", "0", "0", "0", "0", "A"],
                ["A", "0", "0", "0", "0", "0", "0", "A"],
                ["A", "A", "A", "A", "A", "A", "A", "A"]];

var shopExits = [["selya", [3 * squareSize, 14 * squareSize]]];

var shopEnemies = [ new NPC(squareSize * 2, squareSize * 5, 0, hyperColor, shopText, "shopText"), 
                    new NPC(squareSize * 6, squareSize * 5, 0, hyperColor, questText, "questText")];

var shopStatics = [];

let potionShop = new Map(shopData, 2, "potionShop", shopExits, shopEnemies, shopStatics);

//stony area


//desert area

var downMapData = [ ["A", "A", "A", "A", "A", "A", "A", "A", "A", "A", "A", "A", "A", "A", "A", "A", "1", "1", "A", "A", "A", "A", "A", "A", "A", "A", "A", "A", "A", "A", "A", "A", "A", "A", "A"],
                    ["A", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "A"],
                    ["A", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "A"],
                    ["A", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "A"],
                    ["5", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "A"],
                    ["5", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "A"],
                    ["A", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "A"],
                    ["A", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "A"],
                    ["A", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "A"],
                    ["A", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "A"],
                    ["A", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "A"],
                    ["A", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "G", "6", "H", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "A"],
                    ["A", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "B", "/", "D", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "A"],
                    ["A", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "F", "E", "I", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "A"],
                    ["A", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "A"],
                    ["A", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "A"],
                    ["A", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "A"],
                    ["A", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "A"],
                    ["A", "A", "A", "2", "2", "A", "A", "A", "A", "A", "A", "A", "A", "A", "3", "3", "A", "A", "A", "A", "A", "A", "A", "A", "A", "A", "4", "4", "A", "A", "A", "A", "A", "A", "A"]];

var downMapExits =     [new Exit("selya", 1 * squareSize, selyaData.length * squareSize),
                        new Exit("desert_l1", 0, -1 * downMapData.length * squareSize),
                        new Exit("desert_m1", 1 * squareSize, 0),
                        new Exit("desert_r1", 1 * squareSize, 0),
                        new Exit("jungle_r2", 0, 0),
                        new Exit("caves_1", 0, 0)];

var downMapEnemies = [  new Runner(9.5 * squareSize, 9.55 * squareSize),
                        new Runner(25.8 * squareSize, 15.55 * squareSize),
                        new Slime(21.5 * squareSize, 4.65 * squareSize),
                        new Slime(14.15 * squareSize, 4.3 * squareSize)];

var downMapStatics = [];

let downMap = new Map(downMapData, 1, "downMap", downMapExits, downMapEnemies, downMapStatics);


var desertL1Data = [["A", "A", "A", "1", "1", "A", "A", "A"],
                    ["A", "0", "0", "0", "0", "0", "0", "A"],
                    ["A", "0", "0", "0", "0", "0", "0", "A"],
                    ["A", "0", "0", "0", "0", "0", "0", "A"],
                    ["A", "0", "0", "0", "0", "0", "0", "A"],
                    ["A", "0", "0", "0", "0", "0", "0", "A"],
                    ["A", "0", "0", "0", "0", "0", "0", "A"],
                    ["A", "A", "A", "A", "A", "A", "A", "A"]];

var desertL1Exits = [   new Exit("downMap", 0, 1 * (downMap.data.length-1) * squareSize)];

var desertL1Statics = [];

var desertL1Enemies = [];

let desert_l1 = new Map(desertL1Data, 4, "desert_l1", desertL1Exits, desertL1Enemies, desertL1Statics);
//jungle area

//north